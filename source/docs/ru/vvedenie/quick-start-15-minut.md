# Подключить шаблон SIMAI: установить и активировать `/bitrix/templates/simai.framework` (или шаблон решения) для сайта

Для быстрого старта важно, чтобы сайт уже работал на шаблоне SF4 (либо на шаблоне решения, который построен на SF4). Шаблон — это то, что подключает платформенный слой (ядро SF4) и “подхватывает” проектные данные сайта, включая представления областей (`VIEW`) и настройки.

Минимальная проверка на этом шаге простая: открывается любая страница сайта без PHP-ошибок, и доступен интерфейс настроек SF4 (в котором выбираются макеты областей и включаются режимы редактирования).

# Создать страницу и подключить компонент

В SF4 сборка страниц завязана на грид `simai:sf.grid`. На новой странице можно начать с прямого подключения компонента:

```php
<?php

$APPLICATION->IncludeComponent(
    "simai:sf.grid",
    ".default",
    [
        // Здесь может быть задан код представления (VIEW) для конкретной сущности/страницы,
        // если в вашем проекте этот сценарий используется.
    ]
);
```

При этом ключевой практический момент вашего SF4: **представления областей страницы (шапка/подвал/сайдбары/верх-низ контента/главная)** обычно выбираются не “вручную на странице”, а **в настройках сайта** через свойства `grid_view_*` (они лежат в `{site_dir}/simai.data/.site.property.php`).

# Параметр `VIEW` — пример; точное имя и доступные значения уточнять по `.parameters.php` компонента

В вашем проекте слово `VIEW` имеет очень конкретный смысл: это **код сохранённого представления (набор параметров), который загружается из файлов** и определяет, как именно собирается область/сущность.

Для областей страницы активные коды `VIEW` задаются в настройках сайта (через `grid_view_*`) и хранятся в `{site_dir}/simai.data/.site.property.php`, например:

```php
'grid_view_header'      => '005',
'grid_view_footer'      => 'default',
'grid_view_sidebar_left'=> 'default',
'grid_view_main_top'    => 'default',
```

Пользователь выбирает эти коды в интерфейсе настроек (раздел “Макеты областей”), а SF4 потом подставляет соответствующие файлы представлений при сборке страницы.

# Выбрать готовый `view` в `{site_dir}/simai.data/grid/view` и убедиться, что блоки для него есть в `{site_dir}/simai.data/grid/block`

Представление (`view`) в SF4 — это **папка** вида:

* `{site_dir}/simai.data/grid/view/<область>/<код>/`  
* внутри обычно есть `template.php` (главный файл) и `.description.php` (метаданные для UI выбора)

Например, для верхней части контента вы используете:

* `{site_dir}/simai.data/grid/view/main/top/default/`  
* `{site_dir}/simai.data/grid/view/main/top/01/`  
* `{site_dir}/simai.data/grid/view/main/top/empty/`

`template.php` в представлении — это, по сути, сохранённый вызов `simai:sf.grid` в **экспертном виде**, где описаны строки/колонки/области, а также условия показа строк по свойствам (например `show_title`, `show_banner_main`, `include_top_area`).

Блоки и area-шаблоны, которые использует представление, должны существовать в слое проекта — обычно в `{site_dir}/simai.data/grid/block/...`. Если в представлении встречается `...AREA_..._TEMPLATE => "menu.sidebar"` или `"banner.list"`, то у проекта должна быть реализация соответствующих шаблонов/блоков, иначе будет “дырка” в рендере.

# Переопределить блок: при необходимости скопировать системный блок в `{site_dir}/simai.data/grid/block/<code>/template.php`, добавить стили/скрипты

Если нужно изменить внешний вид или логику отдельного блока, безопасный путь такой:

1. Найти код блока/area-шаблона, который используется в `template.php` представления (например, `menu.sidebar`, `page.title`, `banner.list`).  
2. Сделать проектную версию блока/шаблона в `{site_dir}/simai.data/grid/block/...` (чтобы изменения жили в слое решения и не конфликтовали с обновлениями ядра).  
3. При необходимости править параметры блока через view: во view параметры прокидываются ключами вида `ROW_<row>_COL_<col>_AREA_<n>__<AREA_CODE>__<PARAM>`, где `<AREA_CODE>` — это код шаблона в верхнем регистре с заменой точек на подчёркивания (например `page.title` → `PAGE_TITLE`).

Пример типовой настройки заголовка прямо из view:

```php
"ROW_1_COL_0_AREA_0_TEMPLATE" => "page.title",
"ROW_1_COL_0_AREA_0__PAGE_TITLE__TITLE_MODIFIER" => "mt-0 mb-4 t-3 t-md-4",
```

# Подключить свой CSS/JS: прописать пакеты в `{site_dir}/simai.data/config/.asset.config.php`, добавить файлы в `simai.data/template/style|js`

Для быстрых проектных правок чаще всего достаточно подключений через `{site_dir}/simai.data/template` (проектный слой шаблона): так вы добавляете CSS/JS, не вмешиваясь в ядро.

Если вы используете `{site_dir}/simai.data/config/.asset.config.php`, важно помнить ваше правило: **на уровне сайта конфигурация ассетов замещает системную, а не дополняет её**. Это удобно для стабильности (обновления ядра не ломают сайт), но требует дисциплины: проектный конфиг должен описывать полный ожидаемый набор пакетов для сайта.

# Проверить: страница открывается, блоки рендерятся, ассеты грузятся без дублей, кэш очищен

Минимальный чек-лист для “быстрого старта”:

* Страница открывается без PHP/JS ошибок.  
* В настройках сайта для областей выбраны `VIEW` (коды `grid_view_*`), и соответствующие папки реально существуют в `simai.data/grid/view/...`.  
* Представление не ссылается на отсутствующие блоки/area-шаблоны (иначе будут пустые места).  
* Ассеты подключаются один раз и в корректном порядке (без дублей библиотек).  
* После изменений в `simai.data` и `.property.php` очищен релевантный кэш (кэш компонентов Bitrix и то, что влияет на подключение ресурсов).

Если нужно быстро проверить правки конфигурации грида интерактивно: включите режим редактирования в панели SF4, затем включите **режим редактирования гридов** — после этого становится проще диагностировать, какие строки/области реально рендерятся и почему.
